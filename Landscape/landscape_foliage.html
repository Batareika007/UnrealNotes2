<div class="warning-red">
раздел основан на теоретических знаниях и документации UE5. Некоторые элементы могут отличаться в зависимости от версии движка и практического применения. 
</div>

<h1>Foliage — растительность</h1>

<p>
    Система Foliage позволяет размещать большое количество объектов на поверхности ландшафта: 
    траву, кусты, деревья, камни, цветы и любые другие повторяющиеся элементы. 
    В UE5 растительность работает на основе инстансинга, что позволяет размещать тысячи объектов 
    без серьёзной нагрузки на производительность.
</p>

<h2>Как работает Foliage</h2>
<p>
    Когда вы размещаете растительность через Foliage Tool, движок не создаёт отдельные объекты.  
    Вместо этого он объединяет их в один большой инстанс (HISM/ISM), что значительно снижает количество draw calls.
</p>

<p><b>Преимущества:</b></p>
<ul>
    <li>тысячи объектов рендерятся как один;</li>
    <li>высокая производительность;</li>
    <li>удобное управление группами объектов;</li>
    <li>поддержка коллизии, LOD и случайных вариаций.</li>
</ul>

<h2>Типы инстансов</h2>
<ul>
    <li><b>ISM (Instanced Static Mesh)</b> — быстрый, но без поддержки индивидуальных теней.</li>
    <li><b>HISM (Hierarchical Instanced Static Mesh)</b> — поддерживает LOD и фрустум-куллинг.</li>
</ul>

<p>
    В UE5 Foliage Tool автоматически использует HISM, что даёт лучшую производительность.
</p>

<h2>Добавление растительности</h2>
<p>
    Чтобы начать работу:</p>
<ol>
    <li>Откройте вкладку <b>Foliage</b>.</li>
    <li>Перетащите туда меши из Content Browser.</li>
    <li>Включите галочкой те объекты, которые хотите размещать.</li>
    <li>Используйте кисть для нанесения растительности.</li>
</ol>

<h2>Основные инструменты Foliage</h2>

<h3>Paint</h3>
<p>Размещение растительности кистью.</p>

<h3>Erase</h3>
<p>Удаление растительности кистью.</p>

<h3>Brush Size</h3>
<p>Размер кисти.</p>

<h3>Paint Density</h3>
<p>Плотность размещения объектов.</p>

<h3>Erase Density</h3>
<p>Плотность удаления.</p>

<h3>Single Instance Mode</h3>
<p>Размещение одного объекта вручную.</p>

<h3>Place in Current Level</h3>
<p>Размещает растительность в выбранном уровне (важно при работе с World Partition).</p>

<h3>Filters</h3>
<p>Позволяет ограничить размещение по типу поверхности, углу наклона, физическим материалам.</p>

<h3>Reapply</h3>
<p>
    Применяет новые настройки к уже размещённым инстансам.  
    Например, можно изменить:
</p>
<ul>
    <li>масштаб,</li>
    <li>случайный поворот,</li>
    <li>расстояние между объектами,</li>
    <li>выравнивание по нормали.</li>
</ul>

<h3>Select</h3>
<p>
    Позволяет выбрать отдельный инстанс и изменить его вручную:  
    переместить, повернуть, удалить.
</p>

<h3>Select All</h3>
<p>Выделяет все инстансы выбранного типа.</p>

<h3>Select Invalid</h3>
<p>
    Выделяет объекты, размещённые неправильно:  
    под землёй, над землёй, в воздухе.
</p>

<h3>Lasso Select</h3>
<p>Выделение группы объектов в произвольной области.</p>

<h3>Fill</h3>
<p>
    Заполняет выбранную область растительностью полностью.  
    Полезно для создания больших лесов или полей.
</p>

<h2>Производительность</h2>
<p>
    Foliage работает эффективно благодаря инстансингу.  
    Вместо тысячи отдельных объектов движок делает один draw call.
</p>

<p><b>Преимущества:</b></p>
<ul>
    <li>огромное количество объектов без просадок FPS;</li>
    <li>LOD автоматически применяется ко всем инстансам;</li>
    <li>экономия памяти и ресурсов.</li>
</ul>

<h2>Procedural Foliage Volume</h2>
<p>
    Позволяет автоматически генерировать растительность в заданном объёме.  
    Учитывает:
</p>
<ul>
    <li>плотность,</li>
    <li>рост деревьев,</li>
    <li>расстояние между объектами,</li>
    <li>наклон поверхности.</li>
</ul>

<p>
    Это удобно для больших лесов, где ручное размещение слишком долгое.
</p>

<h2>PCG (Procedural Content Generation)</h2>
<p>
    В UE5 PCG стал новой стандартной системой для процедурной генерации.  
    Он позволяет:
</p>
<ul>
    <li>создавать леса, поля, кусты;</li>
    <li>генерировать растительность по слоям ландшафта;</li>
    <li>использовать маски, RVT, высоту, наклон;</li>
    <li>делать динамическую генерацию в реальном времени.</li>
</ul>

<p>
    PCG — современная альтернатива Foliage Tool и Procedural Foliage Volume.
</p>

<h2>Советы по оптимизации</h2>
<ul>
    <li>Используйте HISM для больших лесов.</li>
    <li>Отключайте коллизию у травы и мелких объектов.</li>
    <li>Настраивайте Cull Distance для каждого типа растительности.</li>
    <li>Используйте RVT для смешивания травы с ландшафтом.</li>
    <li>Для больших проектов используйте PCG вместо ручного размещения.</li>
</ul>
